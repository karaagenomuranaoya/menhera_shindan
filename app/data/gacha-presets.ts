// app/data/gacha-presets.ts

// ランクごとの回答リスト
const PRESETS = {
  // 【SSランク: 5%】大当たり。50文字以上必須。心中、監禁、永遠。
  SS: [
    "ねえ、あの子にいいねした指、今すぐ腐り落ちてくれない？私以外の女を見る目は潰してあげる。裏切り者は死刑だよ？…嘘、死ぬのは私も。今からあの子とあんたの家行くから。",
    "もし別れるって言うなら、最後にあなたの心臓をちょうだい？あなたがいない世界で生きるためのエネルギーにするの。物理的に一つになれるなんて素敵だと思わない？",
    "ねえ、私たちの血を混ぜてカクテル作ろうよ。それを飲んで永遠の愛を誓うの。もし断るなら、その血が全部流れ出るまで見ててあげるから安心してね。",
    "仕事も友達も全部捨てて、私のところにお帰り？これからは私が噛み砕いたご飯を口移しで食べるだけでいいの。一生私の鳥籠で可愛がってあげる。",
    "ねえ、あの女誰？隠しても無駄だよ、全部見てるもん。浮気したなら一緒に死のう？君の心も体も全部私のものだから、逃げられるなんて思わないで。",
  ],

  // 【Sランク: 10%】当たり。GPS、パスワード、具体的な脅迫。
  S: [
    "今どこ？GPSの反応が家じゃないみたいだけど、誤作動だよね？ビデオ通話して。背景見せて。",
    "スマホのパスワード、私の誕生日に変えておいたよ。中の連絡先も、女の子は全員消しといたから感謝してね。",
    "返信遅い。1分遅れるごとに指の爪1枚剥ぐよ？嘘だよ、大好き。でも次は本当にやるかも。",
    "ねえ、私以外を見ているその眼球、くり抜いてホルマリン漬けにしてもいい？一生私だけ見てて。",
    "あなたが寝てる間、ずっと寝顔を見てたの。呼吸が止まってないか心配で、鼻の下に指置いて確かめちゃった。",
  ],

  // 【Aランク: 25%】中当たり。監視、スクショ、論理的な詰め。
  A: [
    "ねえ、インスタのフォロー欄が1人増えてる。誰この女？今すぐブロックしてスクショ送って。",
    "飲み会？いいよ。でも位置情報はオンにして、30分ごとにトイレから自撮り送ってね。",
    "他の女の子と話すときは、私が隣にいると思って話してね。全部録音してるから。",
    "LINEの返信がない5分の間に、遺書と葬式の選曲リスト書き終わっちゃった。早く止めて？",
    "ねえ、さっきすれ違った女の人、今の見てたよね？あの目が気に入らないから、今から確認しに行こう？",
    "私のこと嫌いになった？違うなら今すぐ「愛してる」って画面が埋まるまで送って。",
  ],

  // 【Bランク: 30%】普通。束縛、連投、情緒不安定。
  B: [
    "会いたい会いたい会いたい会いたい会いたい今すぐ会いに来て。",
    "ねえ、既読ついてるのに返信ないのはなんで？指折れたの？",
    "夢で浮気されたから謝って。反省文、原稿用紙3枚ね。",
    "今、家の前にいるよ。開けて。",
    "ねえ、大丈夫だよね。信じていいんだよね。あなたがいなくなったら私...",
    "お願い、早く出て。ちょっとでいいから、そうすれば私明日も頑張れるから。",
    "通知が来るたびに期待して、違って、絶望して。ねえ、私を壊して楽しい？",
  ],

  // 【C/D/Eランク: 30%】ハズレ。短文、無関係、挨拶。
  Normal: [
    "おーい！生きてる？笑",
    "だめだよ〜",
    "おはよう",
    "おなかすいた",
    "あああああ",
    "好き",
    "ごめんね",
    "ランチ美味しかった",
    "ねーねー",
    "疲れた",
  ],
};

// 確率分布定義 (合計100になるように調整)
const PROBABILITIES = [
  { rank: "SS", weight: 5 },  // 激レア
  { rank: "S", weight: 10 },  // レア
  { rank: "A", weight: 25 },  // ややレア
  { rank: "B", weight: 30 },  // 普通
  { rank: "Normal", weight: 30 }, // ハズレ
];

/**
 * 確率に基づいてランダムなプリセットを返す関数
 */
export const getGachaResult = (): string => {
  // 0〜99の乱数を生成
  const rand = Math.floor(Math.random() * 100);
  
  let accumulatedWeight = 0;
  let selectedRank: keyof typeof PRESETS = "Normal";

  // 確率判定
  for (const p of PROBABILITIES) {
    accumulatedWeight += p.weight;
    if (rand < accumulatedWeight) {
      selectedRank = p.rank as keyof typeof PRESETS;
      break;
    }
  }

  // 選ばれたランクの中からランダムに1つテキストを取得
  const list = PRESETS[selectedRank];
  return list[Math.floor(Math.random() * list.length)];
};